(("undefined"!=typeof self?self:this).webpackJsonp_pro_gallery_santa_wrapper=("undefined"!=typeof self?self:this).webpackJsonp_pro_gallery_santa_wrapper||[]).push([[17],{262:function(t,i,e){"use strict";var s=e(3),n=function(){function t(){this.styles={},this.container={},this.id="",this._cache={}}return t.prototype.getOrPutInCache=function(t,i){return this._cache[t]||(this._cache[t]=i()),this._cache[t]},t.prototype.dumpCache=function(){this._cache={}},t.prototype.updateParams=function(t){var i=t.styles,e=t.container,s=t.id;this.dumpCache(),this.id=s||this.id,this.styles=i||this.styles,this.container=e||this.container},t.prototype.getGalleryDimensions=function(){var t=this;return this.getOrPutInCache("galleryDimensions",(function(){var i={galleryWidth:Math.ceil(t.getGalleryWidth()),galleryHeight:Math.ceil(t.getGalleryHeight()),scrollBase:t.container.scrollBase?Math.ceil(t.container.scrollBase):0,height:Math.ceil(t.container.height),width:Math.ceil(t.container.width)};if(t.container.externalScrollBase&&(i.scrollBase+=t.container.externalScrollBase),t.styles.hasThumbnails){var e=t.styles.thumbnailSize+t.styles.galleryMargin+3*t.styles.thumbnailSpacings;switch(t.styles.galleryThumbnailsAlignment){case"top":case"bottom":i.galleryHeight-=e;break;case"left":case"right":i.galleryWidth-=e}}else t.styles.isSlideshow&&(i.galleryHeight-=t.styles.slideshowInfoSize);return i}))},t.prototype.getGalleryWidth=function(){var t=this;return this.getOrPutInCache("galleryWidth",(function(){var i=Math.floor(t.container.width)+2*t.getDimensionFix();return t.styles.arrowsPosition===s.a.arrowsPosition.OUTSIDE_GALLERY&&t.styles.scrollDirection===s.a.scrollDirection.HORIZONTAL&&(i-=2*(t.styles.arrowsSize+40+t.styles.imageMargin/2)),i}))},t.prototype.getGalleryHeight=function(){var t=this;return this.getOrPutInCache("galleryHeight",(function(){return Math.floor((t.container.height>0?t.container.height:0)+(t.styles.scrollDirection===s.a.scrollDirection.HORIZONTAL?t.getDimensionFix():0))}))},t.prototype.getDimensionFix=function(){var t=this;return this.getOrPutInCache("dimensionFix",(function(){return Number(t.styles.imageMargin/2)-Number(t.styles.galleryMargin)}))},t.prototype.getGalleryRatio=function(){var t=this;return this.getOrPutInCache("galleryRatio",(function(){var i=t.getGalleryDimensions();return i.galleryWidth/i.galleryHeight}))},t}();i.a=new n},364:function(t,i,e){"use strict";e.r(i);var s=e(0),n=e(262),o=e(3),r=e(8),a=e(76),l={SCROLL:"SCROLL",CLICKED:"CLICKED",HOVERED:"HOVERED",ENDED:"ENDED",INIT_SCROLL:"INIT_SCROLL"},h=function(){function t(t){var i=this;this.scrollBase=0,this.videoItems=[],this.currentPlayingIdx=-1,this.currentItemCount=0,this.playing=!1,this.updateGalleryStructure=this.updateGalleryStructure.bind(this),this.initializePlayState=this.initializePlayState.bind(this),this.onScroll=this.onScroll.bind(this),this.handleEvent=this.handleEvent.bind(this),this.play=this.play.bind(this),this.stop=this.stop.bind(this),this.isVisible=this.isVisible.bind(this),this.videoPlay=void 0,this.itemClick=void 0,this.setPlayingVideos=t.setPlayingVideos,this.lastVideoPlayed=-1,this.videoRatingMap=new Map,this.trigger=Object.assign.apply(Object,Object(s.f)([{}],Object.keys(l).map((function(t){var e;return(e={})[t]=function(e){return i.handleEvent({eventName:t,eventData:e})},e}))))}return t.prototype.updateGalleryStructure=function(t){var i=this,e=t.galleryStructure,s=t.scrollBase,o=t.videoPlay,r=t.videoLoop,a=t.itemClick,l=t.scrollDirection;this.galleryWidth=n.a.getGalleryDimensions().galleryWidth,this.scrollBase=s,this.videoPlay=o,this.videoLoop=r,this.itemClick=a,this.scrollDirection=l,this.currentItemCount=e.galleryItems.length,this.videoItems=[],e.galleryItems.forEach((function(t){("video"===t.type||"image"===t.type&&(t.id.includes("_placeholder")||t.isVideoPlaceholder))&&(i.videoRatingMap.has(t.id)||i.videoRatingMap.set(t.id,t.idx),i.videoItems.push(t))}))},t.prototype.handleEvent=function(t){var i=t.eventName,e=t.eventData;switch(i){case l.SCROLL:this.onScroll(e);break;case o.a.events.ITEM_ACTION_TRIGGERED:this.itemClicked(e.idx);break;case o.a.events.HOVER_SET:this.itemHovered(e);break;case o.a.events.VIDEO_ENDED:this.videoEnded(e.idx);break;case o.a.events.VIDEO_PLAYED:this.videoPlayed(e.idx);break;case o.a.events.VIDEO_ERROR:this.videoErrorReported()}},t.prototype.itemHovered=function(t){"hover"===this.videoPlay&&this.IdxExistsInVideoItems(t)&&this.play(t)},t.prototype.itemClicked=function(t){"onClick"===this.videoPlay&&this.IdxExistsInVideoItems(t)&&(this.currentPlayingIdx===t?this.stop():this.play(t))},t.prototype.onScroll=function(t){var i=this,e=t.top,s=t.left;this.top=e>=0?e:this.top,this.left=s>=0?s:this.left,-1===this.currentPlayingIdx||this.isCurrentVideoStillVisible({top:this.top,left:this.left})||this.stop(this.videoItems.findIndex((function(t){return t.idx===i.currentPlayingIdx}))),this.autoPlayNextVideoByRating({top:this.top,left:this.left})},t.prototype.videoEnded=function(t){var i=this.videoItems.findIndex((function(i){return i.idx===t}));this.stop(i);var e={top:this.top,left:this.left};this.autoPlayNextVideoByRating(e)},t.prototype.videoPlayed=function(t){this.lastVideoPlayed=t},t.prototype.videoErrorReported=function(){this.stop()},t.prototype.initializePlayState=function(){this.autoPlayNextVideoByRating({top:this.top,left:this.left})},t.prototype.autoPlayNextVideoByRating=function(t){var i=this,e=t.top,s=t.left;if(this.shouldAutoPlay()){var n={idx:-1,rating:1/0},o={idx:-1,rating:1/0};if(this.videoItems.some((function(t){if(i.isVisible(t,{top:e,left:s})){var r=i.videoRatingMap.get(t.id);return r<=o.rating?(n.idx=o.idx,n.rating=o.rating,o.idx=t.idx,o.rating=r):r<=n.rating&&(n.idx=t.idx,n.rating=r),!1}return o.idx>=0})),o.idx>=0)if(this.allowedLoop()||o.idx!==this.lastVideoPlayed)this.play(o.idx);else{if(!(n.idx>=0))return;this.play(n.idx)}else this.lastVideoPlayed=-2}},t.prototype.calculateCurrentItemPlacement=function(){var t=this;return this.videoItems.findIndex((function(i){return i.idx===t.currentPlayingIdx}))},t.prototype.play=function(t){this.setPlayingIdx(t),this.playing=!0},t.prototype.stop=function(t){if(t>=0){var i=this.videoRatingMap.get(this.videoItems[t].id)+this.currentItemCount;this.videoRatingMap.set(this.videoItems[t].id,i)}this.setPlayingIdx(-1),this.playing=!1},t.prototype.onPlayingIdxChange=function(){this.setPlayingVideos(this.currentPlayingIdx)},t.prototype.setPlayingIdx=function(t){this.currentPlayingIdx!==t&&(this.currentPlayingIdx=t,this.onPlayingIdxChange())},t.prototype.isCurrentVideoStillVisible=function(t){var i=t.top,e=t.left,s=this.calculateCurrentItemPlacement();return this.isVisible(this.videoItems[s],{top:i,left:e})},t.prototype.isVisible=function(t,i){var e,s=i.top,n=i.left,l={offsetTop:this.scrollBase||0,scrollY:s,scrollLeft:n},h=(t.offset.top-t.offset.bottom)/2,c=(t.offset.left-t.offset.right)/2,d=Object(a.b)({target:l,scrollBase:this.scrollBase,top:t.offset.top,bottom:t.offset.top+t.style.height,screenHeight:r.a&&r.a.innerHeight,padding:h});return e=this.scrollDirection===o.a.scrollDirection.VERTICAL||Object(a.a)({target:l,left:t.offset.left,right:t.offset.left+t.style.width,screenWidth:this.galleryWidth||r.a&&r.a.innerWidth,padding:c}),d&&e},t.prototype.shouldAutoPlay=function(){return"auto"===this.videoPlay},t.prototype.allowedLoop=function(){return!0===this.videoLoop},t.prototype.IdxExistsInVideoItems=function(t){return this.videoItems.some((function(i){return i.idx===t}))},t}();i.default=h}}]);
//# sourceMappingURL=proGallery_videoScrollHelper.chunk.min.js.map